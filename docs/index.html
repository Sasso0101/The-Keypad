<!DOCTYPE html>
<html>
  <head>
    <!-- Origin Trial Token, feature = WebUSB (For Chrome M57+), origin = https://webusb.github.io, expires = 2017-06-19 -->
    <meta http-equiv="origin-trial" data-feature="WebUSB (For Chrome M57+)" data-expires="2017-06-19" content="Ag83MurQOa5N4SKRCqqtSlbycfe08s5LgUiqEI7J3jTk2NEIpRp7SLPz2i+EBDuXyf+AeRMdD6BI++kTSJmGzQEAAABReyJvcmlnaW4iOiJodHRwczovL3dlYnVzYi5naXRodWIuaW86NDQzIiwiZmVhdHVyZSI6IldlYlVTQjIiLCJleHBpcnkiOjE0OTc4OTM2OTV9">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>The Keypad</title>
    <link rel="stylesheet" href="style.css">

    <script>
      let deferredPrompt;
      window.addEventListener('beforeinstallprompt', (e) => {
        // Prevent the mini-infobar from appearing on mobile
        e.preventDefault();
        // Stash the event so it can be triggered later.
        deferredPrompt = e;
        // Update UI notify the user they can install the PWA
        showInstallPromotion();
      });
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/service-worker.js');
        });
      }
    </script>
  </head>
  <body>
    <div id="interface">
      <div id="keypadContainer">
        <div id="guide">
          <h2>"The Keypad" is not connected</h2>
          <p>1. Connect "The Keypad" to any USB port</p>
          <p>2. Click connect</p>
          <div class="buttonContainer">
            <button class="connect" onclick="document.querySelector('#connect').click();">Connect</button>
          </div>
        </div>
        <div id="keypad" style="display:none;"></div>
      </div>
      <aside>
        <div class="configuration">
          <div class="tabs">
            <div>Actions</div>
            <div>LEDs</div>
          </div>
          <div id="actions"></div>
        </div>
        <div class="status">
          <p id="connectionStatus"></p>
          <button id="connect" class="connect">Connect</button>
        </div>
      </aside>
      <p id="noConnect" class="error">Connect a device to configure its actions.</p>
      <p id="noSelect" class="error" style="display:none;">Select a key to configure its action.</p>
      <div id="settings" style="display:none;">
        <div id="keyPreview">V+</div>
        <div class="settingsControls">
          <h2>Button <span id="buttonNumber"></span></h2>
          <p>Action: <span id="action"></span></p>
          <select name="options" id="options">
          </select>
        </div>
      </div>
    </div>
    <script src="js/serial.js"></script>
    <script src="js/events.js"></script>
    <script src="js/webUSB.js"></script>
  </body>
</html>
